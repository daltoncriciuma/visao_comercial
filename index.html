<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>H2O – Visor em Tela Cheia</title>
  <style>
    :root { color-scheme: dark; }
    html, body {
      margin: 0; padding: 0;
      width: 100vw; height: 100vh;
      background:#000; color:#fff; overflow:hidden;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    /* Área central em tela cheia */
    .stage {
      position:fixed; inset:0;
      display:grid; place-items:center; background:#000;
    }
    /* Caixa com tamanho BASE que será escalada para caber na tela */
    .scale-box {
      width: 1600px;   /* BASE_W (ajustado via JS) */
      height: 900px;   /* BASE_H (ajustado via JS) */
      transform-origin: 50% 50%;
      will-change: transform;
      background:#000;
    }
    iframe {
      width:100%; height:100%;
      border:0; display:block; background:#000;
    }
    /* Toolbar discreta */
    .toolbar {
      position:fixed; right:12px; bottom:12px;
      display:flex; gap:8px; align-items:center;
      background:rgba(0,0,0,.55); border:1px solid rgba(255,255,255,.15);
      padding:6px 10px; border-radius:10px; font-size:12px; backdrop-filter:blur(4px);
      opacity:.95; transition: opacity .35s ease;
    }
    .toolbar.hidden { opacity:0; pointer-events:none; }
    .btn {
      cursor:pointer; border:1px solid rgba(255,255,255,.25);
      background:rgba(255,255,255,.08);
      padding:6px 10px; border-radius:8px; font-weight:600;
    }
    .btn:hover { background:rgba(255,255,255,.15); }
    .muted { opacity:.8 }

    /* Piscar 3x ao carregar */
    .flash {
      position:fixed; inset:0; pointer-events:none;
      background:radial-gradient(ellipse at center, rgba(255,255,255,.12), rgba(255,255,255,0) 60%);
      animation: flash3 1.5s ease-out 1 both;
    }
    @keyframes flash3 {
      0%{opacity:0} 10%{opacity:1} 20%{opacity:0} 40%{opacity:1} 55%{opacity:0} 75%{opacity:1} 100%{opacity:0}
    }
  </style>
</head>
<body>
  <div class="stage">
    <div class="scale-box" id="scaleBox">
      <iframe id="frame" title="H2O – Exibição" allowfullscreen
        referrerpolicy="no-referrer-when-downgrade"></iframe>
    </div>
  </div>

  <div class="toolbar hidden" id="toolbar">
    <button class="btn" id="zoomOut">−</button>
    <button class="btn" id="zoomReset">100%</button>
    <button class="btn" id="zoomIn">+</button>
    <button class="btn" id="reloadBtn">Recarregar</button>
    <span class="muted" id="stamp">—</span>
  </div>

  <div class="flash" aria-hidden="true"></div>

  <script>
    // ===== CONFIG =====
    // Use pubchart OU pubhtml:
    // const IFRAME_URL = "https://docs.google.com/spreadsheets/d/e/.../pubchart?oid=221298120&format=interactive";
    const IFRAME_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR24Vx4SCLyGxtnD8X0tYOnBIZJ_Y10BYhYwaESp2Sui60TTEgC13hvPO8vKNtiMYp35L-A9LcGNmHB/pubhtml?gid=1852779965&single=true&widget=true&headers=false";

    // Tamanho base do quadro (a página será escalada para caber na tela)
    const BASE_W = 1600;  // 1920 para ainda maior
    const BASE_H = 900;   // 1080 para ainda maior

    const AUTO_RELOAD_MINUTES = 60; // recarrega automático
    const ZOOM_STEP = 0.07;
    let userZoom = 1.00;  // zoom manual adicional (1.00 = 100%)

    // ===== Helpers =====
    function setBaseSize() {
      const box = document.getElementById("scaleBox");
      box.style.width  = BASE_W + "px";
      box.style.height = BASE_H + "px";
    }

    // Calcula escala para caber na tela e mantém centralizado
    function fitToScreen() {
      const vw = window.innerWidth;
      const vh = window.innerHeight;
      const scaleFit = Math.min(vw / BASE_W, vh / BASE_H);
      const scale = scaleFit * userZoom;
      document.getElementById("scaleBox").style.transform = `scale(${scale})`;
      updateZoomLabel(scale);
    }

    function buildUrl() {
      const sep = IFRAME_URL.includes("?") ? "&" : "?";
      return IFRAME_URL + sep + "cb=" + Date.now();
    }

    function loadFrame() {
      document.getElementById("frame").src = buildUrl();
      const now = new Date();
      const two = n => String(n).padStart(2,"0");
      document.getElementById("stamp").textContent =
        `Carregado: ${two(now.getHours())}:${two(now.getMinutes())}`;
    }

    // Zoom manual
    function zoomIn(){ userZoom = Math.min(2.0, +(userZoom + ZOOM_STEP).toFixed(2)); fitToScreen(); }
    function zoomOut(){ userZoom = Math.max(0.5, +(userZoom - ZOOM_STEP).toFixed(2)); fitToScreen(); }
    function zoomReset(){ userZoom = 1.00; fitToScreen(); }
    function updateZoomLabel(effectiveScale){
      document.getElementById("zoomReset").textContent =
        Math.round(userZoom * 100) + "%";
    }

    // Toolbar: aparece ao mover o mouse e some depois de 4s
    let hideTimer=null;
    function showToolbar(){
      const tb=document.getElementById("toolbar");
      tb.classList.remove("hidden");
      clearTimeout(hideTimer);
      hideTimer=setTimeout(()=>tb.classList.add("hidden"), 4000);
    }
    window.addEventListener("mousemove", showToolbar);
    window.addEventListener("resize", fitToScreen);
    window.addEventListener("keydown", (e)=>{
      if(e.key === "+") { zoomIn(); showToolbar(); }
      if(e.key === "-") { zoomOut(); showToolbar(); }
      if(e.key === "0") { zoomReset(); showToolbar(); }
      if(e.key.toLowerCase() === "r") { loadFrame(); showToolbar(); }
    });

    // Botões
    document.getElementById("zoomIn").addEventListener("click", zoomIn);
    document.getElementById("zoomOut").addEventListener("click", zoomOut);
    document.getElementById("zoomReset").addEventListener("click", zoomReset);
    document.getElementById("reloadBtn").addEventListener("click", loadFrame);

    // Inicialização
    setBaseSize(); fitToScreen(); loadFrame();
    if (AUTO_RELOAD_MINUTES > 0) {
      setInterval(loadFrame, AUTO_RELOAD_MINUTES * 60 * 1000);
    }
  </script>
</body>
</html>
