<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dashboards H2O - Rotação</title>
  <style>
    :root { --bg:#000; --fg:#fff; --muted:#9aa0a6; --glass:rgba(0,0,0,.5); }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    .overlay{
      position:fixed;inset:0 auto auto 0;width:100%;padding:10px 16px;z-index:10;
      display:flex;align-items:center;justify-content:space-between;background:var(--glass);backdrop-filter:saturate(140%) blur(6px)
    }
    .spacer{width:140px;height:40px}
    .title{position:absolute;left:50%;transform:translateX(-50%);font-weight:700;letter-spacing:.3px}
    /* esconder o título do topo */
    #docTitle{display:none!important;}

    .stage{position:fixed;inset:0}
    iframe{position:absolute;inset:0;border:0;width:100%;height:100%;background:linear-gradient(180deg,#111,#000)}
    .status{
      position:fixed;left:50%;top:56px;transform:translateX(-50%);
      background:var(--glass);padding:6px 10px;border-radius:8px;font-size:12px;color:var(--muted)
    }
    .hidden{display:none}
  </style>
</head>
<body>
  <div class="overlay">
    <div class="spacer"></div>
    <div id="docTitle" class="title">Carregando…</div>
    <div class="spacer"></div>
  </div>

  <div id="stage" class="stage"></div>
  <div id="status" class="status hidden">Carregando…</div>

  <script>
    // ====== CONFIG ======
    const defaultSeconds = 60; // tempo entre trocas
    const dashboards = [
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vQabryl5zw9NO6AkZT4MIv3ZVzN33M4taW_VoIDRyouzS1bKUhSHjFu9hkTGIInpJdn5zXJbJiPm3OK/pubhtml?gid=915060596&single=true&widget=true&headers=false",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vR24Vx4SCLyGxtnD8X0tYOnBIZJ_Y10BYhYwaESp2Sui60TTEgC13hvPO8vKNtiMYp35L-A9LcGNmHB/pubhtml?gid=74611085&single=true&widget=true&headers=false",
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vTRiAUmq-3rdKt0gdiiH2U0c06Lum3hx44s5dMYLFKQLEzbnv7gCh65WkKWtu1SEwnoGRHOcTynIMnw/pubhtml?gid=915060596&single=true&widget=true&headers=false"
    ];
    // ====== FIM CONFIG ======

    const qs = new URLSearchParams(location.search);
    const intervalMs = (parseInt(qs.get("t"),10) || defaultSeconds) * 1000;

    const stage = document.getElementById("stage");
    const statusEl = document.getElementById("status");

    let idx = -1, timer = null, currentFrame = null;

    function setStatus(msg){
      if (!msg){ statusEl.classList.add("hidden"); statusEl.textContent = ""; return; }
      statusEl.textContent = msg; statusEl.classList.remove("hidden");
    }

    function loadDashboard(i){
      const src = dashboards[i];
      setStatus("Carregando…");

      const iframe = document.createElement("iframe");
      iframe.referrerPolicy = "no-referrer";
      iframe.loading = "eager";
      iframe.src = src;

      iframe.addEventListener("load", () => setStatus(""));
      iframe.addEventListener("error", () => setStatus("Erro ao carregar este dashboard."));

      if (currentFrame){ stage.removeChild(currentFrame); }
      stage.appendChild(iframe);
      currentFrame = iframe;
    }

    function next(){ idx = (idx + 1) % dashboards.length; loadDashboard(idx); }
    function start(){ next(); clearInterval(timer); timer = setInterval(next, intervalMs); }

    // atalhos: espaço = pausa/retoma; setas = anterior/próximo
    let paused = false;
    document.addEventListener("keydown", (e) => {
      if (e.code === "Space"){ paused = !paused; paused ? clearInterval(timer) : start(); }
      if (e.code === "ArrowRight"){ clearInterval(timer); next(); }
      if (e.code === "ArrowLeft"){ clearInterval(timer); idx = (idx - 2 + dashboards.length) % dashboards.length; next(); }
    });

    dashboards.length ? start() : setStatus("Sem dashboards configurados");
  </script>
</body>
</html>
